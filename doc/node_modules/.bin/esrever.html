<!DOCTYPE html>
<html>
<head>
  <title>esrever</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/.bin/esrever";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>esrever</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>

(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

	<span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
	<span class="hljs-keyword">var</span> esrever = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../esrever.js'</span>);
	<span class="hljs-keyword">var</span> reverse = esrever.reverse;
	<span class="hljs-keyword">var</span> strings = process.argv.splice(<span class="hljs-number">2</span>);
	<span class="hljs-keyword">var</span> option = strings.shift();
	<span class="hljs-keyword">var</span> isFile = <span class="hljs-literal">false</span>;
	<span class="hljs-keyword">var</span> maintainLineOrder = <span class="hljs-literal">false</span>;
	<span class="hljs-keyword">var</span> stdin = process.stdin;
	<span class="hljs-keyword">var</span> data;
	<span class="hljs-keyword">var</span> log = <span class="hljs-built_in">console</span>.log;
	<span class="hljs-keyword">var</span> main = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

		<span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^(?:-h|--help)$/</span>.test(option) || option == <span class="hljs-literal">null</span> &amp;&amp; !strings.length) {
			log(<span class="hljs-string">'esrever v%s - https://mths.be/esrever'</span>, esrever.version);
			log(<span class="hljs-string">'\nUsage:\n'</span>);
			log(<span class="hljs-string">'\tesrever [string ...]'</span>);
			log(<span class="hljs-string">'\tesrever [-f | --file] [file ...]'</span>);
			log(<span class="hljs-string">'\tesrever [-l | --lines] [file ...]'</span>);
			log(<span class="hljs-string">'\tesrever [-v | --version]'</span>);
			log(<span class="hljs-string">'\tesrever [-h | --help]'</span>);
			log(<span class="hljs-string">'\nExamples:\n'</span>);
			log(<span class="hljs-string">'\tesrever \'ma\xF1ana man\u0303ana\''</span>);
			log(<span class="hljs-string">'\tesrever -f foo.txt'</span>);
			log(<span class="hljs-string">'\tesrever -l foo.txt'</span>);
			log(<span class="hljs-string">'\techo \'I put my thang down, flip it, and reverse it.\' | esrever'</span>);
			log(<span class="hljs-string">'\n\n\tesrever "H\u0339\u0319\u0326\u032E\u0349\u0329\u0317\u0317\u0367\u0307\u030F\u030A\u033EE\u0368\u0346\u0352\u0306\u036E\u0303\u034F\u0337\u032E\u0323\u032B\u0324\u0323 \u0335\u031E\u0339\u033B\u0300\u0309\u0313\u036C\u0351\u0361\u0345C\u036F\u0302\u0350\u034F\u0328\u031B\u0354\u0326\u031F\u0348\u033BO\u031C\u034E\u034D\u0359\u035A\u032C\u031D\u0323\u033D\u036E\u0350\u0357\u0300\u0364\u030D\u0300\u0362M\u0334\u0321\u0332\u032D\u034D\u0347\u033C\u031F\u032F\u0326\u0309\u0312\u0360\u1E1A\u031B\u0319\u031E\u032A\u0317\u0365\u0364\u0369\u033E\u0351\u0314\u0350\u0345\u1E6E\u0334\u0337\u0337\u0317\u033C\u034D\u033F\u033F\u0313\u033D\u0350H\u0319\u0319\u0314\u0304\u035C"\n\n'</span>);
			<span class="hljs-keyword">return</span> process.exit(<span class="hljs-number">1</span>);
		}

		<span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^(?:-v|--version)$/</span>.test(option)) {
			log(<span class="hljs-string">'v%s'</span>, esrever.version);
			<span class="hljs-keyword">return</span> process.exit(<span class="hljs-number">1</span>);
		}

		<span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^(?:-f|--file)$/</span>.test(option)) {
			isFile = <span class="hljs-literal">true</span>;
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^(?:-l|--lines)$/</span>.test(option)) {
			maintainLineOrder = <span class="hljs-literal">true</span>;
			isFile = <span class="hljs-literal">true</span>; <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> enable this option for strings too</span>
		} <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>The first argument is not a recognized option; treat it as a string</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">			option &amp;&amp; strings.unshift(option);
		}

		<span class="hljs-keyword">if</span> (!strings.length) {
			log(<span class="hljs-string">'Error: option `%s` requires an argument.'</span>, option);
			log(<span class="hljs-string">'Try `esrever --help` for more information.'</span>);
			<span class="hljs-keyword">return</span> process.exit(<span class="hljs-number">1</span>);
		}

		strings.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">string</span>) </span>{
			<span class="hljs-keyword">var</span> result;
			<span class="hljs-keyword">if</span> (isFile) {
				<span class="hljs-keyword">try</span> {
					string = fs.readFileSync(string, <span class="hljs-string">'utf8'</span>);
				} <span class="hljs-keyword">catch</span>(error) {
					log(<span class="hljs-string">'Error: no such file. (`%s`)'</span>, string);
					<span class="hljs-keyword">return</span> process.exit(<span class="hljs-number">1</span>);
				}
			}
			<span class="hljs-keyword">try</span> {
				<span class="hljs-keyword">if</span> (maintainLineOrder) {
					result = string.split(<span class="hljs-regexp">/\r\n?|\n/g</span>).map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">line</span>) </span>{
						<span class="hljs-keyword">return</span> reverse(line);
					}).join(<span class="hljs-built_in">require</span>(<span class="hljs-string">'os'</span>).EOL);
				} <span class="hljs-keyword">else</span> {
					result = reverse(string);
				}
				log(result);
			} <span class="hljs-keyword">catch</span>(error) {
				log(<span class="hljs-string">'Error: failed to reverse.'</span>);
				log(<span class="hljs-string">'If you think this is a bug in esrever, please report it:'</span>);
				log(<span class="hljs-string">'https://github.com/mathiasbynens/esrever/issues/new'</span>)
				<span class="hljs-keyword">return</span> process.exit(<span class="hljs-number">1</span>);
			}
		});
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Return with exit status 0 outside of the <code>forEach</code> loop, in case
multiple strings or files were passed in.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		<span class="hljs-keyword">return</span> process.exit(<span class="hljs-number">0</span>);

	};

	<span class="hljs-keyword">if</span> (stdin.isTTY) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>handle shell arguments</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		main();
	} <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>handle pipe</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">		data = <span class="hljs-string">''</span>;
		stdin.on(<span class="hljs-string">'data'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">chunk</span>) </span>{
			data += chunk;
		});
		stdin.on(<span class="hljs-string">'end'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
			strings.unshift(data.trim());
			main();
		});
		stdin.resume();
	}

}());

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
